mutate(issue_d = str_replace(issue_d, "-.*", ""),
issue_d = case_when(
issue_d == "7" ~ "2007",
issue_d == "8" ~ "2008",
issue_d == "9" ~ "2009",
issue_d == "10" ~ "2010",
issue_d == "11" ~ "2011"),
purpose = ifelse(purpose == "credit_card" | purpose == "debt_consolidation", "debt", "other"))
lc2b <- na.omit(lc2b) %>%
group_by(purpose, issue_d) %>%
summarize(sum = n())
q2b = lc2b %>%
ggplot(aes(x=issue_d, y=cumsum(sum), group=purpose)) +
geom_area(aes(fill=purpose)) +
scale_fill_brewer(palette="Blues")+
labs(y="Total Number of Loans",
x="Years 2007 -2011",
fill="Purpose",
caption="Source: Lending Club",
title="Cumulative Number of Debt Loans") +
theme(panel.background = element_rect(fill="white"),
panel.grid.major.y = element_line(color="steelblue", linetype=3),
plot.caption = element_text(face="italic"),
plot.subtitle = element_text(face="italic", size = 10),
legend.position = "none") +
geom_text(x="2010",y=40000,label="DEBT", color = "black") +
geom_text(x="2010",y=20000,label="OTHER", color="black")
q2b
# org chart
edges <- subset(thurman.org, thurman.org$Node1 != thurman.org$Node2)
net<-network(edges,directed=TRUE)
network.edgecount(net, na.omit = TRUE)
dei <- degree(net, cmode = "outdegree")
dlabel <- network.vertex.names(net)[which.max(dei)]
p <- ggnet2(net,
size="degree",
label = dlabel,
max_size = 20,
label.color = "black",
label.size = 3,
arrow.size = 6,
arrow.gap = .06,
node.color="steelblue",
edge.color="steelblue",
legend.position = "none") +
labs(title = "Thurman Organizational Network")
p
edges <- subset(thurman.soc, thurman.soc$Node1 != thurman.soc$Node2)
net<-network(edges,directed=TRUE)
network.edgecount(net, na.omit = TRUE)
dei <- degree(net, cmode = "outdegree")
dlabel <- network.vertex.names(net)[which.max(dei)]
de_grey = 85 - round(dei/ max(dei), digits=1)*60
de_colors = paste("grey", de_grey,sep="")
de_label_colors = ifelse(de_grey<=40, "white", "black")
p <- ggnet2(net,
size="degree",
label = dlabel,
max_size = 20,
label.color = de_label_colors,
label.size = 3,
arrow.size = 6,
arrow.gap = .06,
node.color=de_colors,
legend.position = "none")  +
labs(title = "Thurman Social Network")
p
lc <- na.omit(lc)
lc_2a <- lc
View(dji)
dji$change <- dji$Close - dji$Open
View(dji)
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
View(dji)
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95)
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
geom_text(aes(x = time.x,
y = pmin(balance, balance + change) - 100,
label = change))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
theme(legend.position="none",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="firebrick2")
theme(legend.position="none",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="FireBrick2")
theme(legend.position="none",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2")
theme(legend.position="none",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25, # control bar gap width
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
theme(legend.position="none",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)
library(scales)
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)+
scale_y_continuous(breaks=c(1,4, 26, 47, 63), labels = c("Start", "July", "August", "September", "End-Sep25" ))+
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)+
scale_x_continuous(breaks=c(1,4, 26, 47, 63), labels = c("Start", "July", "August", "September", "End-Sep25" ))+
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)+
scale_x_continuous(breaks=c(4, 26, 47, 63), labels = c("July", "August", "September", "Sep 25" ))+
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1))
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_brewer(palette="Dark2") +
scale_y_continuous("Balance", labels = dollar)+
scale_x_continuous(breaks=c(4, 26, 47, 63), labels = c("July", "August", "September", "Sep 25" ))+
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1)) +
labs(title = "Dow Jones Waterfall Chart",
x = "Time (June 27 - Sep 25)",
y = "Stock Price")
q2c
dji$change <- dji$Close - dji$Open
dji$balance <- cumsum(c(0, dji$change[-nrow(dji)]))
dji$time.x <- 1:nrow(dji)
dji$flow <- factor(sign(dji$change))
dji$next.time <- lead(dji$time.x)
q2c <- ggplot(dji, aes(x = time.x, fill = flow)) +
geom_rect(aes(xmin = time.x - 0.25,
xmax = time.x + 0.25,
ymin = balance,
ymax = balance + change),
color="black",
alpha=0.95) +
scale_fill_manual(values = c("-1" = "red", "1" = "black")) +
scale_y_continuous("Balance", labels = dollar)+
scale_x_continuous(breaks=c(4, 26, 47, 63), labels = c("July", "August", "September", "Sep 25" ))+
theme(legend.position="bottom",
panel.background = element_rect(fill="white",color="black"),
axis.line.x = element_line(color="black"),
panel.grid.major.x = element_line(color="grey95", linetype=1),
panel.grid.major.y = element_line(color="grey80", linetype=1),
panel.grid.minor.y = element_line(color="grey95", linetype=1)) +
labs(title = "Dow Jones Waterfall Chart",
x = "Time (June 27 - Sep 25)",
y = "Stock Price")
q2c
meg_df <- data.frame(ID, Symptoms, Sex)
meg_df <- data.frame(ID = numeric(),
Symptoms = character(),
Sex = character())
View(meg_df)
meg_df$ID = ID
ID = c(1,2,3,4)
meg_df$ID = ID
meg_df <- data.frame(ID = numeric(0),
Symptoms = character(0),
Sex = character(0))
ID = c(1,2,3,4)
meg_df$ID = ID
meg_df <- rbind(meg_df, ID)
View(p1)
View(meg_df)
meg_df <- cbind(meg_df, ID)
View(meg_df)
meg_df <- data.frame(ID = numeric(0),
Symptoms = character(0),
Sex = character(0))
meg_df <- cbind(meg_df, ID)
meg_df <- data.frame(ID = ID,
Symptoms = sxs,
Sex = NA)
ID = c(1,2,3,4)
sxs = c('a', 'b', 'c', 'd')
meg_df <- data.frame(ID = ID,
Symptoms = sxs,
Sex = NA)
meg_df$Sex %>% replace_na("")
meg_df$Sex <- replace_na(NA,
"")
library(tidyverse)
meg_df$Sex %>$ replace_na("")
meg_df$Sex %>$ replace_na("")
meg_df$Sex %>% replace_na("")
meg_df$Sex %>% replace_na("")
meg_df$Sex <- ifelse(is.na(meg_df%Sex) == TRUE, "", meg_df$Sex)
meg_df$Sex <- ifelse(is.na(meg_df%Sex) == TRUE, meg_df$Sex = "", meg_df$Sex = meg_df$Sex)
meg_df[meg_df == NA] <- ""
View(meg_df)
meg_df[is.na(meg_df) == TRUE] <- ""
# Problem 1
library(datasets)
cw <- chickwts
View(cw)
ggplot(cw, aes(x=feed, y = weight)) +
geom_boxplot()
library(ggplot2)
ggplot(cw, aes(x=feed, y = weight)) +
geom_boxplot()
library(datasets)
library(ggplot2)
# Problem 1
cw <- chickwts
ggplot(cw, aes(x=feed, y = weight)) +
geom_boxplot()
aov1 <- aov(weight ~ feed, data = cw)
summary(aov1)
library(datasets)
library(ggplot2)
library(MASS)
# Problem 2
cush <- Cushings
View(cush)
ggplot(cush, aes(x=type, y = Pregnanetriol)) +
geom_boxplot()
ggplot(cush, aes(x=Type, y = Pregnanetriol)) +
geom_boxplot()
aov2 <- aov(Pregnanetriol ~ Type, data = cush)
summary(aov2)
gt <- genotype
View(gt)
aov3 <- (Wt ~ Mother, data = gt)
summary(aov3)
aov3 <- aov(Wt ~ Mother, data = gt)
summary(aov3)
aov4 <- aov(Wt ~ Litter, data = gt)
summary(aov4)
library(gplots)
plotmeans(Wt ~ Mother, data = gt)
plotmeans(Wt ~ Litter, data = gt)
ax <- anorexia
View(ax)
ax$diff <- ax$Prewt - ax$Postwt
plotmeans(diff ~ Treat, data = ax)
aov4 <- aov(diff ~ Treat, data = ax)
summary(aov4)
cb <- cabbages
View(cb)
aov5 <- aov(vitC ~ Cult + Date, data = cb)
summary(aov5)
aov5 <- aov(VitC ~ Cult + Date, data = cb)
summary(aov5)
install.packages("GGally")
install.packages("GGally")
install.packages("GGally")
install.packages("GGally")
library(tidyverse)
library(tidyselect)
library(ggplot2)
library(GGally)
library(janitor)
library(kableExtra)
library(stringr)
cncr <- read_csv("cancer_reg.csv")
cncr_2 <- cncr %>%
select(-c(avgAnnCount, avgDeathsPerYear, incidenceRate, binnedInc, studyPerCap))
setwd("C:/Users/kryan/Desktop/Projects/Data Science/Biostatistics/CancerRate")
# Reading in Data
cncr <- read_csv("cancer_reg.csv")
cncr_2 <- cncr %>%
select(-c(avgAnnCount, avgDeathsPerYear, incidenceRate, binnedInc, studyPerCap))
race <- cncr_2 %>%
select(deathRate, PctWhite, PctBlack, PctAsian, PctOtherRace)
View(race)
ggpairs(race)
library(GGally)
library(GGally)
ggpairs(race)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library(GGally)
library(ggplot2)
library(GGally)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
